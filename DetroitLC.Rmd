---
title: "Detroit Metro Land Cover Data"
author: "K. Arthur Endsley"
date: "Wednesday, November 05, 2014"
output: pdf_document
---

# Data Sources

All dollar values were adjusted for inflation to 2010 values.

## Potential SocialExplorer Census Measures

* Population density (`SE_T003_001`)
* Median household income (`SE_T093_001`)

* Normalized by housing unit count (`SE_T155_001`)...
  * Occupied housing units (`SE_T156_001`)
  * Occupied housing units: owner occupied (`SE_T156_002`)

* Normalized by land area (`SE_T004_002`)...
  * Housing unit count (`SE_T155_001`)
  * Male population (`SE_T005_002`)
  * Female population (`SE_T005_003`)
  * White population (`SE_T014_002`)
  * Black or African American population (`SE_T014_002`)
  * Asian population (`SE_T014_005`)
  * Households (`SE_T020_001`)
  * Family households (`SE_T020_002`)
  * Married-couple households (`SE_T020_003`)
  * Family households with Male householder, no spouse present (`SE_T020_005`)
  * Family households with Female householder, no spouse present (`SE_T020_006`)
  * Non-family households with Male householder (`SE_T020_008`)
  * Non-family households with Female householder (`SE_T020_009`)
  
* Normalized by family household population (`SE_T025_003`)...
  * Householders (`SE_T025_004`)
  * Children in households (`SE_T025_006`)
  * Grandchildren in households (`SE_T025_007`)
  * Parents in households (`SE_T025_009`)
  * Non-relatives in households (`SE_T025_011`)
  
* Normalized by non-family household population (`SE_T025_012`)...
  * Population living alone (`SE_T025_013`)
  
* Normalized by total population (`SE_T025_001`)...
  * Population in group quarters (`SE_T025_016`)
  * Population 16 years and over (`SE_T069_001`)
  * Population poor or struggling (`SE_T185_004`)

* Normalized by population in group quarters (`SE_T025_016`)...
  * Institutionalized population (`SE_T025_017`)
  
* Normalized by population 16 years and over (`SE_T069_001`)...
  * Population 16 and over in the labor force (`SE_T069_002`)
  
* Normalized by population 16 and over in the labor force (`SE_T069_002`)...
  * Employed civilians in the labor force (`SE_T069_005`)

## U.S. Census

* [Decennial Census overview and 1990, 2000 datasets](http://www.census.gov/prod/www/decennial.html)
* [Maps and geographic data](http://www.census.gov/geo/maps-data/)

# Methodology

1. Prep census data with "naive" approach; using only corresponding census tracts (to bypass tedious crosswalking for now).
2. Spatially join census tract attributes to census tract boundaries.
3. [For SEMCOG data... Create common grid of SEMCOG layers.]
4. Rasterize census tracts to NLCD grid.
5. Set up Bayesian network.
6. Learn Bayesian network on 2001 NLCD up to 2006 NLCD.

## Cross-Walking Census Data

From [U.S. 2010: Discover America in a New Century](http://www.s4.brown.edu/us2010/Researcher/ltdb3.htm): "The crosswalk identifies what portion of a tract in one year should be allocated to a 2010 tract. For every decennial year from 1970 to 2000, every row in the crosswalk lists a 2010 tract ID, the ID of a tract in the source year that contributes to it, and the share of the source tract's population attributes that should be allocated to the 2010 tract. In cases where there is an exact correspondence between the source tract and the 2010 tract, there is only one row of data for the 2010 tract. Otherwise there are as many rows as there are contributing tracts."

Reference to use is: "John R. Logan, Zengwang Xu, and Brian Stults. 2012. “Interpolating US Decennial Census Tract Data from as Early as 1970 to 2010: A Longitudinal Tract Database” Professional Geographer, forthcoming."

```
chmod 664 crosswalk_2000_2010.csv
sudo -u arthur psql -d rdetroit -c "CREATE TABLE census_crosswalk (trtid00 character varying(255), trtid10 character varying(255), weight numeric, placefp10 integer, cbsa10 integer, metdiv10 integer, ccflag10 integer, changetype integer)"
sudo -u arthur psql -d rdetroit -c "COPY census_crosswalk (trtid00, trtid10, weight, placefp10, cbsa10, metdiv10, ccflag10, changetype) FROM '/home/arthur/Downloads/crosswalk_2000_2010.csv' WITH (FORMAT csv, HEADER)"
```

## Naive Census Tract Correspondence

```{r}
setwd('/home/arthur/Downloads')
options(stringsAsFactors=FALSE)

census.vars <- c('SE_T003_001', 'SE_T093_001', 'SE_T155_001', 'SE_T156_001', 'SE_T156_002', 'SE_T004_002', 'SE_T005_002', 'SE_T005_003', 'SE_T014_002', 'SE_T014_005', 'SE_T020_001', 'SE_T020_002', 'SE_T020_003', 'SE_T020_005', 'SE_T020_006', 'SE_T020_008', 'SE_T020_009', 'SE_T025_003', 'SE_T025_004', 'SE_T025_006', 'SE_T025_007', 'SE_T025_009', 'SE_T025_011', 'SE_T025_012', 'SE_T025_013', 'SE_T025_001', 'SE_T025_016', 'SE_T069_001', 'SE_T185_004', 'SE_T025_017', 'SE_T069_002', 'SE_T069_005')

census2000 <- read.csv('census2000.csv', header=T, skip=1) # 2000 Census data
acs2006.2010 <- read.csv('acs2006-2010.csv', header=T, skip=1) # 2006-2010 ACS data
tracts <- union(census2000$Census.Tract, acs2006.2010$Census.Tract)
xwalk <- arrange(read.csv('crosswalk_2000_2010.csv', colClasses=c('character', 'character')),
                 trtid10) # 2000 to 2010 Crosswalk data

require(plyr)
census2000 <- mutate(census2000, trtid=paste0(Geo_STATE, Geo_COUNTY, Geo_TRACT))
acs2006.2010 <- mutate(acs2006.2010, trtid=paste0(Geo_STATE, Geo_COUNTY, Geo_TRACT))

# Subset the crosswalk table to just those tracts in our census data
xwalk <- subset(xwalk, trtid00 %in% intersect(census2000$trtid, xwalk$trtid00),
                select=c(trtid00, trtid10, weight))
```

## Land Cover Data Preparation

```{r preamble, warning=FALSE, results=FALSE, message=FALSE}
library(sp)
library(raster)
library(rgdal)
```

```{r data.management}
file.loc <- '/home/arthur/Workspace/TermProject/'
rast <- raster::raster(paste0(file.loc, 'nlcd2001_sample.tif'))
```

Next, I reclassify the NLCD raster into three classes:

```{r reclass.explication, echo=FALSE}
knitr::kable(data.frame('Input Class Range'=c('[0-10]', '11 (Open Water)', '[12-20]', '[21-23] (Open and Low, Medium Development)', '24 (High Development)', '[25-99]'), 'Output Class'=c(0,NA,0,1,2,0), 'New Class Label'=c('Undeveloped', 'Excluded', 'Undeveloped', 'Low-Intensity Development', 'High-Intensity Development', 'Undeveloped')), col.names=c('Input Class Range', 'Output Class', 'New Class Label'))
```

```{r reclass}
reclass.matrix <- matrix(c(c(0,10,0), c(10,11,NA), c(12,20,0),
                           c(20,23,1), c(23,24,2), c(24,99,0)),
                         byrow=TRUE, ncol=3)
dev <- reclassify(rast, reclass.matrix, right=TRUE) # Intervals closed on right
```

# Questions

* What census tract boundaries are used in the American Community Survey? \textbf{The 2010 tract boundaries are used.} [(Source)](http://www.census.gov/geo/maps-data/data/pdfs/tiger/How_do_I_choose_TIGER_vintage.pdf)

